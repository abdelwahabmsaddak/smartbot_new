<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body { background:#0f0f11; color:#fff; font-family:"Cairo",sans-serif; }
        .admin-container { width:90%; margin:40px auto; }
        h1 { margin-bottom:20px; }
        .box { background:#1a1a1d; padding:20px; border-radius:10px; margin-bottom:20px; }

        input, textarea, select {
            width:100%; padding:10px; border:1px solid #333;
            background:#111; color:#fff; border-radius:8px; margin-top:8px;
        }

        {% extends "base.html" %}

{% block content %}
<h2>ğŸ”¥ Dashboard</h2>

<p>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ {{ user.username }} ğŸ‘‹</p>
{% endblock %}
        button {
            background:#3a7afe; border:none; padding:10px 20px;
            color:#fff; font-size:16px; border-radius:8px; cursor:pointer; margin-top:10px;
        }

        table { width:100%; border-collapse:collapse; margin-top:20px; }
        table th, table td {
            border:1px solid #333; padding:12px; background:#111; text-align:center;
        }

        .btn-edit { background:#22d3ee; }
        .btn-delete { background:#ef4444; }
        .btn-generate { background:#805ad5; }
    </style>
</head>
<body>

<div class="admin-container">

    <h1>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©</h1>

    <!-- Ø¥Ø¶Ø§ÙØ© Ù…Ù‚Ø§Ù„ Ø¬Ø¯ÙŠØ¯ -->
    <div class="box">
        <h2>Ø¥Ø¶Ø§ÙØ© Ù…Ù‚Ø§Ù„ Ø¬Ø¯ÙŠØ¯</h2>

        <input id="title" type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‚Ø§Ù„">
        <textarea id="content" rows="6" placeholder="Ù†Øµ Ø§Ù„Ù…Ù‚Ø§Ù„"></textarea>

        <button onclick="addPost()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‚Ø§Ù„</button>
        <button class="btn-generate" onclick="generatePost()">ØªÙˆÙ„ÙŠØ¯ Ù…Ù‚Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
    </div>

    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª -->
    <div class="box">
        <h2>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª</h2>
        <table id="postsTable">
            <thead>
                <tr>
                    <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                    <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                    <th>ØªØ¹Ø¯ÙŠÙ„</th>
                    <th>Ø­Ø°Ù</th>
                </tr>
            </thead>
            <tbody id="postsBody">
                <!-- ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¨Ø§Ùƒ Ø§Ù†Ø¯ -->
            </tbody>
        </table>
    </div>

</div>

<script>
async function loadPosts() {
    const res = await fetch("/api/posts");
    const data = await res.json();

    const table = document.getElementById("postsBody");
    table.innerHTML = "";

    data.forEach(post => {
        table.innerHTML += `
            <tr>
                <td>${post.title}</td>
                <td>${post.status}</td>
                <td><button class="btn-edit" onclick="editPost(${post.id})">ØªØ¹Ø¯ÙŠÙ„</button></td>
                <td><button class="btn-delete" onclick="deletePost(${post.id})">Ø­Ø°Ù</button></td>
            </tr>
        `;
    });
}
loadPosts();

async function addPost() {
    const t = document.getElementById("title").value;
    const c = document.getElementById("content").value;

    const res = await fetch("/api/add_post", {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:JSON.stringify({ title:t, content:c })
    });

    loadPosts();
}

async function deletePost(id) {
    await fetch(`/api/delete_post/${id}`, { method:"DELETE" });
    loadPosts();
}

async function generatePost() {
    const res = await fetch("/api/generate_post");
    const data = await res.json();
    document.getElementById("title").value = data.title;
    document.getElementById("content").value = data.content;
}
</script>

</body>
</html>
