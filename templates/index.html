{% set lang = request.args.get('lang') if request.args.get('lang') else 'en' %}
{% set is_ar = (lang == 'ar') %}
<!doctype html>
<html lang="{{ 'ar' if is_ar else 'en' }}" dir="{{ 'rtl' if is_ar else 'ltr' }}">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SmartBot â€” AI Market Intelligence</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='chat_widget.css') }}">

  <!-- Optional: Google font (safe fallback if blocked) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body class="sb-body {{ 'rtl' if is_ar else '' }}">

  <!-- Top Nav -->
  <header class="sb-nav">
    <div class="sb-container sb-nav-inner">
      <a class="sb-brand" href="/">
        <span class="sb-badge">âš¡</span>
        <span class="sb-brand-text">SmartBot</span>
      </a>

      <nav class="sb-links">
        <a href="/analysis">{{ 'ØªØ­Ù„ÙŠÙ„' if is_ar else 'Analysis' }}</a>
        <a href="/whales">{{ 'Ø§Ù„Ø­ÙŠØªØ§Ù†' if is_ar else 'Whales' }}</a>
        <a href="/auto-trade">{{ 'Ø§Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ' if is_ar else 'Auto Trade' }}</a>
        <a href="/blog">{{ 'Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©' if is_ar else 'Blog' }}</a>
        <a href="/pricing">{{ 'Ø§Ù„Ø£Ø³Ø¹Ø§Ø±' if is_ar else 'Pricing' }}</a>
      </nav>

      <div class="sb-nav-actions">
        <!-- Lang toggle keeps current path -->
        {% if is_ar %}
          <a class="sb-chip" href="{{ request.path }}?lang=en">EN</a>
        {% else %}
          <a class="sb-chip" href="{{ request.path }}?lang=ar">AR</a>
        {% endif %}
        <a class="sb-btn sb-btn-ghost" href="/login">{{ 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' if is_ar else 'Sign in' }}</a>
        <a class="sb-btn sb-btn-primary" href="/register">{{ 'Ø§Ø¨Ø¯Ø£ Ù…Ø¬Ø§Ù†Ù‹Ø§' if is_ar else 'Start free' }}</a>
      </div>

      <button class="sb-burger" id="sbBurger" aria-label="Menu">â˜°</button>
    </div>

    <!-- Mobile menu -->
    <div class="sb-container sb-mobile" id="sbMobileMenu">
      <a href="/analysis">{{ 'ØªØ­Ù„ÙŠÙ„' if is_ar else 'Analysis' }}</a>
      <a href="/whales">{{ 'Ø§Ù„Ø­ÙŠØªØ§Ù†' if is_ar else 'Whales' }}</a>
      <a href="/auto-trade">{{ 'Ø§Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ' if is_ar else 'Auto Trade' }}</a>
      <a href="/blog">{{ 'Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©' if is_ar else 'Blog' }}</a>
      <a href="/pricing">{{ 'Ø§Ù„Ø£Ø³Ø¹Ø§Ø±' if is_ar else 'Pricing' }}</a>
      <div class="sb-mobile-cta">
        <a class="sb-btn sb-btn-ghost" href="/login">{{ 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' if is_ar else 'Sign in' }}</a>
        <a class="sb-btn sb-btn-primary" href="/register">{{ 'Ø§Ø¨Ø¯Ø£ Ù…Ø¬Ø§Ù†Ù‹Ø§' if is_ar else 'Start free' }}</a>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <main class="sb-main">
    <section class="sb-hero">
      <div class="sb-container sb-hero-grid">
        <div class="sb-hero-left">
          <div class="sb-pill">
            <span class="dot"></span>
            <span>{{ 'Ù…Ù†ØµØ© Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù„Ø£Ø³ÙˆØ§Ù‚' if is_ar else 'AI-powered market intelligence' }}</span>
          </div>

          <h1 class="sb-h1">
            {{ 'Ø­Ù„Ù‘Ù„ Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ø¨Ø«Ù‚Ø© â€”' if is_ar else 'Analyze markets with confidence â€”' }}
            <span class="sb-grad">{{ 'Ø¨Ø°ÙƒØ§Ø¡' if is_ar else 'with AI' }}</span>
          </h1>

          <p class="sb-sub">
            {{ 'Crypto â€¢ Gold â€¢ Halal Stocks â€” ØªØ­Ù„ÙŠÙ„ Ø³Ø±ÙŠØ¹ØŒ ØªØªØ¨Ø¹ Ø§Ù„Ø­ÙŠØªØ§Ù†ØŒ ÙˆÙ„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙˆØ§Ø¶Ø­Ø©.' if is_ar
               else 'Crypto â€¢ Gold â€¢ Halal stocks â€” fast analysis, whale tracking, and a clean dashboard.' }}
          </p>

          <div class="sb-hero-cta">
            <a class="sb-btn sb-btn-primary sb-btn-lg" href="/register">
              {{ 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† Ù…Ø¬Ø§Ù†Ù‹Ø§' if is_ar else 'Start free now' }}
            </a>
            <a class="sb-btn sb-btn-ghost sb-btn-lg" href="/analysis">
              {{ 'Ø¬Ø±Ù‘Ø¨ Ø§Ù„ØªØ­Ù„ÙŠÙ„' if is_ar else 'Try analysis' }}
            </a>
          </div>

          <div class="sb-trust">
            <div class="sb-trust-item">ğŸ”’ <span>{{ 'Live Ù…Ù‚ÙÙˆÙ„ Ø­ØªÙ‰ Ø§Ù„ØªØ­Ù‚Ù‚' if is_ar else 'Live locked until verification' }}</span></div>
            <div class="sb-trust-item">âš¡ <span>{{ 'Ø³Ø±ÙŠØ¹ ÙˆØ®ÙÙŠÙ' if is_ar else 'Fast & lightweight' }}</span></div>
            <div class="sb-trust-item">ğŸ“± <span>{{ 'Responsive Ù„Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„Ø­Ø§Ø³ÙˆØ¨' if is_ar else 'Mobile + desktop ready' }}</span></div>
          </div>
        </div>

        <!-- Right card -->
        <div class="sb-hero-right">
          <div class="sb-card sb-card-glow">
            <div class="sb-card-top">
              <div class="sb-card-title">
                <span class="sb-icon">ğŸ“Š</span>
                <strong>{{ 'Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø°ÙƒÙŠØ©' if is_ar else 'Smart Dashboard' }}</strong>
              </div>
              <span class="sb-status">{{ 'Ø¬Ø§Ù‡Ø²' if is_ar else 'Ready' }}</span>
            </div>

            <div class="sb-mock">
              <div class="sb-mock-row">
                <div class="sb-mock-kpi">
                  <div class="kpi-label">{{ 'ØªØ­Ù„ÙŠÙ„' if is_ar else 'Analysis' }}</div>
                  <div class="kpi-value">AI</div>
                </div>
                <div class="sb-mock-kpi">
                  <div class="kpi-label">{{ 'Ø­ÙŠØªØ§Ù†' if is_ar else 'Whales' }}</div>
                  <div class="kpi-value">24/7</div>
                </div>
                <div class="sb-mock-kpi">
                  <div class="kpi-label">{{ 'ØªØ¯Ø§ÙˆÙ„' if is_ar else 'Trade' }}</div>
                  <div class="kpi-value">Paper</div>
                </div>
              </div>

              <div class="sb-mock-line"></div>
              <div class="sb-mock-list">
                <div class="sb-mock-item">
                  <span class="tag">{{ 'Halal' }}</span>
                  <span class="txt">{{ 'Screen stocks â€¢ alerts' }}</span>
                </div>
                <div class="sb-mock-item">
                  <span class="tag">{{ 'Gold' }}</span>
                  <span class="txt">{{ 'Trend â€¢ levels â€¢ risk' }}</span>
                </div>
                <div class="sb-mock-item">
                  <span class="tag">{{ 'Crypto' }}</span>
                  <span class="txt">{{ 'Signals â€¢ confidence' }}</span>
                </div>
              </div>

              <a class="sb-mini-link" href="/dashboard">
                {{ 'Ø§Ø°Ù‡Ø¨ Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…' if is_ar else 'Open dashboard' }} â†’
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Features (4 cards only) -->
    <section class="sb-section">
      <div class="sb-container">
        <h2 class="sb-h2">{{ 'Ù…Ø§Ø°Ø§ ØªØ³ØªØ·ÙŠØ¹ Ø£Ù† ØªÙØ¹Ù„ØŸ' if is_ar else 'What you can do' }}</h2>

        <div class="sb-features">
          <a class="sb-feature" href="/analysis">
            <div class="ic">ğŸ”</div>
            <div>
              <div class="t">{{ 'Market Analysis' }}</div>
              <div class="d">{{ 'Crypto â€¢ Gold â€¢ Halal stocks' }}</div>
            </div>
          </a>

          <a class="sb-feature" href="/whales">
            <div class="ic">ğŸ‹</div>
            <div>
              <div class="t">{{ 'Whale Tracking' }}</div>
              <div class="d">{{ 'Big moves â€¢ smart alerts' }}</div>
            </div>
          </a>

          <a class="sb-feature" href="/auto-trade">
            <div class="ic">ğŸ¤–</div>
            <div>
              <div class="t">{{ 'Auto Trading' }}</div>
              <div class="d">{{ 'Paper first â€¢ Live later' }}</div>
            </div>
          </a>

          <a class="sb-feature" href="/dashboard">
            <div class="ic">ğŸ“ˆ</div>
            <div>
              <div class="t">{{ 'Dashboard' }}</div>
              <div class="d">{{ 'PnL â€¢ trades â€¢ performance' }}</div>
            </div>
          </a>
        </div>
      </div>
    </section>

    <!-- Blog preview -->
    <section class="sb-section">
      <div class="sb-container sb-blog-head">
        <h2 class="sb-h2">{{ 'Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©' if is_ar else 'From the blog' }}</h2>
        <a class="sb-mini-link" href="/blog">{{ 'Ø§Ù„Ù…Ø²ÙŠØ¯' if is_ar else 'See all' }} â†’</a>
      </div>

      <div class="sb-container sb-blog-grid">
        <!-- If you already have posts in backend, loop here -->
        {% if posts %}
          {% for p in posts[:3] %}
          <a class="sb-post" href="/blog/{{ p.slug }}">
            <div class="sb-post-top">
              <span class="sb-post-tag">{{ p.tag or 'Guide' }}</span>
              <span class="sb-post-date">{{ p.date or '' }}</span>
            </div>
            <div class="sb-post-title">{{ p.title }}</div>
            <div class="sb-post-desc">{{ p.excerpt }}</div>
          </a>
          {% endfor %}
        {% else %}
          <!-- Fallback placeholders -->
          <a class="sb-post" href="/blog">
            <div class="sb-post-top">
              <span class="sb-post-tag">Guide</span>
              <span class="sb-post-date">â€¢</span>
            </div>
            <div class="sb-post-title">How to start with Paper mode</div>
            <div class="sb-post-desc">Safer testing before Live trading.</div>
          </a>
          <a class="sb-post" href="/blog">
            <div class="sb-post-top">
              <span class="sb-post-tag">Halal</span>
              <span class="sb-post-date">â€¢</span>
            </div>
            <div class="sb-post-title">Halal stocks screening basics</div>
            <div class="sb-post-desc">Simple checks to stay compliant.</div>
          </a>
          <a class="sb-post" href="/blog">
            <div class="sb-post-top">
              <span class="sb-post-tag">Whales</span>
              <span class="sb-post-date">â€¢</span>
            </div>
            <div class="sb-post-title">Whale alerts: what matters</div>
            <div class="sb-post-desc">Avoid noise, focus on real signals.</div>
          </a>
        {% endif %}
      </div>
    </section>

    <!-- Final CTA -->
    <section class="sb-cta">
      <div class="sb-container sb-cta-inner">
        <div>
          <h3 class="sb-h3">{{ 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† Ù…Ø¬Ø§Ù†Ù‹Ø§' if is_ar else 'Start free now' }}</h3>
          <p class="sb-sub2">{{ 'Ø¨Ø¯ÙˆÙ† Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù†ÙƒÙŠØ© â€” Paper Ø£ÙˆÙ„Ø§Ù‹ØŒ Ø«Ù… Live Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚.' if is_ar else 'No card required â€” Paper first, Live after verification.' }}</p>
        </div>
        <a class="sb-btn sb-btn-primary sb-btn-lg" href="/register">
          {{ 'Ø§Ø¨Ø¯Ø£ Ù…Ø¬Ø§Ù†Ù‹Ø§' if is_ar else 'Start free' }}
        </a>
      </div>
    </section>

    <footer class="sb-footer">
      <div class="sb-container sb-footer-inner">
        <div class="sb-foot-left">
          <div class="sb-brand-foot"><span class="sb-badge">âš¡</span> SmartBot</div>
          <div class="sb-foot-note">{{ 'AI tools for smarter decisions.' }}</div>
        </div>

        <div class="sb-foot-links">
          <a href="/about">{{ 'Ø­ÙˆÙ„' if is_ar else 'About' }}</a>
          <a href="/contact">{{ 'Ø§ØªØµÙ„ Ø¨Ù†Ø§' if is_ar else 'Contact' }}</a>
          <a href="/terms">{{ 'Ø§Ù„Ø´Ø±ÙˆØ·' if is_ar else 'Terms' }}</a>
        </div>
      </div>
    </footer>
  </main>

  <!-- Chat Widget (small like messenger) -->
  {% include "chat_widget.html" %}

  <script>
    const burger = document.getElementById('sbBurger');
    const menu = document.getElementById('sbMobileMenu');
    if (burger && menu) burger.addEventListener('click', () => menu.classList.toggle('open'));
  </script>

  <script src="{{ url_for('static', filename='chat_widget.js') }}"></script>
</body>
</html>
