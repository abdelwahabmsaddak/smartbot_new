<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Market Screener PRO</title>
    <link rel="stylesheet" href="/static/style.css">

    <style>
        body {padding:20px; font-family:Arial;}
        .box {background:#fff; padding:20px; border-radius:10px; margin-bottom:20px; box-shadow:0 0 8px #ddd;}
        label {font-weight:bold;}
        .filters {display:grid; grid-template-columns:repeat(3,1fr); gap:15px;}
        table {width:100%; border-collapse:collapse; margin-top:20px;}
        th,td {padding:10px; border-bottom:1px solid #ddd; text-align:center;}
        th {background:#f4f4f4;}
        button {background:#007bff; color:white; padding:10px 20px; border:none; border-radius:8px; cursor:pointer;}
        button:hover {background:#0059d1;}
    </style>
</head>

<body>

<h2>ğŸ“Š Market Screener PRO</h2>

<div class="box">
    <h3>ğŸ” Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h3>

    <div class="filters">
        <div>
            <label>Ø§Ù„Ù†ÙˆØ¹</label>
            <select id="assetType">
                <option value="crypto">Crypto</option>
                <option value="stocks">Stocks</option>
                <option value="gold">Gold</option>
            </select>
        </div>

        <div>
            <label>Ù†Ø³Ø¨Ø© Ø§Ù„ØªØºÙŠØ± 24h</label>
            <select id="change24">
                <option value="any">Ø£ÙŠ</option>
                <option value="up">â¬† ØµØ¹ÙˆØ¯</option>
                <option value="down">â¬‡ Ù‡Ø¨ÙˆØ·</option>
            </select>
        </div>

        <div>
            <label>Ø§Ù„Ø­Ø¬Ù… Volume</label>
            <select id="volume">
                <option value="any">Ø£ÙŠ</option>
                <option value="high">Ù…Ø±ØªÙØ¹</option>
                <option value="medium">Ù…ØªÙˆØ³Ø·</option>
                <option value="low">Ø¶Ø¹ÙŠÙ</option>
            </select>
        </div>

        <div>
            <label>Ù…Ø¤Ø´Ø± RSI</label>
            <select id="rsi">
                <option value="any">Ø£ÙŠ</option>
                <option value="oversold">ğŸ”µ Oversold (RSI < 30)</option>
                <option value="overbought">ğŸ”´ Overbought (RSI > 70)</option>
            </select>
        </div>

        <div>
            <label>MACD</label>
            <select id="macd">
                <option value="any">Ø£ÙŠ</option>
                <option value="bullish">ğŸ“ˆ Bullish</option>
                <option value="bearish">ğŸ“‰ Bearish</option>
            </select>
        </div>

        <div>
            <label>EMA</label>
            <select id="ema">
                <option value="any">Ø£ÙŠ</option>
                <option value="ema50">EMA50 Break</option>
                <option value="ema200">EMA200 Break</option>
            </select>
        </div>
    </div>

    <br>
    <button onclick="loadScreener()">Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
</div>

<h3>ğŸ“‹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>

<table id="resultsTable">
    <thead>
        <tr>
            <th>Ø§Ù„Ø±Ù…Ø²</th>
            <th>Ø§Ù„Ø³Ø¹Ø±</th>
            <th>Ø§Ù„ØªØºÙŠØ±</th>
            <th>Ø§Ù„Ø­Ø¬Ù…</th>
            <th>RSI</th>
            <th>MACD</th>
            <th>Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
function loadScreener() {

    let filters = {
        assetType: document.getElementById("assetType").value,
        change24: document.getElementById("change24").value,
        volume: document.getElementById("volume").value,
        rsi: document.getElementById("rsi").value,
        macd: document.getElementById("macd").value,
        ema: document.getElementById("ema").value
    };

    fetch("/api/screener", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(filters)
    })
    .then(res => res.json())
    .then(data => {
        let tbody = document.querySelector("#resultsTable tbody");
        tbody.innerHTML = "";

        data.forEach(row => {
            let tr = `
            <tr>
                <td>${row.symbol}</td>
                <td>${row.price}</td>
                <td>${row.change24}</td>
                <td>${row.volume}</td>
                <td>${row.rsi}</td>
                <td>${row.macd}</td>
                <td>${row.final_signal}</td>
            </tr>`;
            tbody.innerHTML += tr;
        });
    });
}
</script>

</body>
</html>
